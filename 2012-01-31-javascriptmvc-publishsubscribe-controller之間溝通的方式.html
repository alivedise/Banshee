---
layout: post
title: "[javascriptMVC] publish/subscribe - controller之間溝通的方式"
date: 2012-01-31 11:46
categories: javascriptmvc
comments: true
---
$.Controller將OpenAjax包進來當做一種controller之間互相溝通的方式。
現在有兩個controller: controller_a, controller_b，
controller_a要發一個訊息給controller_b，
發佈方要使用$.Controller.prototype.publish

``` js
this.publish('Namespace.Eventname.Nested', option);
```

接收方使用$.Controller內建的subscribe註冊此事件

``` js
'Namespace.Eventname.Nested subscribe': function(published_event, option){});
```

完整範例與jsfiddle如下（要記得偷jquery/controller/subscribe進來）：

``` js

steal('jquery/class', 'jquery/model', 'jquery/dom/fixture', 'jquery/view/ejs','jquery/controller', 'jquery/controller/subscribe', function($) {

// Define Acontroller, pusblish event whenever instance is inited.
$.Controller("Acontroller", {
"init": function(element, options) {
this.publish('Alive.Acontroller.Inited', this);
}
});

// Define Bcontroller, listen to Acontroller inited event.
$.Controller('Bcontroller', {
// update the todo instance
"Alive.Acontroller.Inited subscribe": function(published, option) {
steal.dev.log(published, option);
}
});

// create bcontroller first
new Bcontroller('#element_b');
// create acontroller
new Acontroller('#element_a');
//steal.js INFO: Alive.Acontroller.Inited Class

})

```

jsfiddle
{ % jsfiddle NCeeR % }
